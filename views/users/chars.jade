-	function render(__str, __data) {
-		Object.keys(__data).forEach(function(key) {
-			__str = __str.replace("{"+key+"}", __data[key].toString());
-		});
-		return __str;
-	}
//- create a standard menu link
mixin menuLink(__item, __data)
	- var __data  = __data || {};
	- var __curr  = __item.url === _Menu.currentURL;
	- var __url   = __item.url ? (__curr ? null : render(__item.url, __data)) : null;
	- var __title = render(__item.title, __data);
	li(class=__curr ? "active" : null)
		if Array.isArray(__item.sign)
			a(href=__url)
				span.hidden-xs(class=__item.sign.join(" "))
				span.visible-xs!=__title
		else
			a(href=__url)!=__title

//- create a menu dropdown item
mixin menuDropdown(__item, __data)
	- var __data  = __data || {};
	li.dropdown
		a.dropdown-toggle(data-toggle="dropdown")!=render(__item.title, __data)
			b.caret
		ul.dropdown-menu
			each __link in __item.dropdown
				if __link.title
					+menuLink(__link, __data)
				else
					li.divider

doctype html
html(lang="de")
	head
		meta(charset="utf-8")
		title DCM – DSA Charakter Manager
		link(rel="stylesheet", href="//netdna.bootstrapcdn.com/bootswatch/3.1.1/spacelab/bootstrap.min.css")
		link(rel="stylesheet", href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css")
		script(src="//code.jquery.com/jquery.min.js")
		script(src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js")
		style.
			.delete {
				padding: 5px 10px;
				border-radius: 7px;
			}
			.delete:hover {
				background-color: orange;
				color: white;
			}
			.gap-bottom {
				padding-bottom: 1.5em;
			}
	body
		nav.navbar.navbar-default(role="navigation")
			.container-fluid
				.navbar-header
					button.navbar-toggle(type="button", data-toggle="collapse", data-target="#navbar-collapse-chars")
						span.sr-only Navigation
						span.icon-bar
						span.icon-bar
						span.icon-bar
					span.navbar-brand DCM
				#navbar-collapse-chars.collapse.navbar-collapse
					- var data = _FRCount ? { badge: '<span class="badge">'+_FRCount+'</span>' } : { badge: "" };
					ul.nav.navbar-nav
						each __link in _Menu.left
							if Array.isArray(__link.dropdown)
								+menuDropdown(__link, data)
							else
								+menuLink(__link, data)
					ul.nav.navbar-nav.navbar-right
						each __link in _Menu.right
							if Array.isArray(__link.dropdown)
								+menuDropdown(__link, data)
							else
								+menuLink(__link, data)
						if _User.isAdmin
							li
								a(href="/db", title="Manage DB")
									span.hidden-xs.fa.fa-hdd-o
									span.visible-xs Manage DB
		main.container
			.page-header.text-center
				h1
					span.fa.fa-file-text-o &nbsp;
					span Helden &nbsp;
			ul.nav.nav-pills.nav-justified.gap-bottom
				li
					a(href="/neu") 
						span.fa.fa-edit
						|  Neuen Helden erstellen
				li
					a(title="Helden-Software XML")
						span.fa.fa-upload
						|  Helden importieren
				li
					a(href="/papierkorb")
						span.fa.fa-trash-o
						|  gelöschte Helden
					
			.panel.panel-default
				.panel-heading
					h4 Meine Helden
				ul#my-chars.list-group
					each __held in _Own
						li.list-group-item
							a(href="/held/"+__held._id)= __held.Person.Name + " ( " + __held.AP.frei + " / " + __held.AP.alle.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " )"
							span.fa.fa-trash-o.pull-right.delete(title="Held löschen", data-id=__held._id.toString())
			each __friend in _Group
				.panel.panel-default
					.panel-heading
						h4 Helden von #{__friend.local.name}
					ul.list-group
						each __held in __friend.chars
							li.list-group-item
								a(href="/held/"+__held._id)= __held.Person.Name + " ( " + __held.AP.frei + " / " + __held.AP.alle.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " )"
			script.
				$('.delete').on("click", function() {
					var $row = $(this).closest('li');
					$.post(
						"/held/" + this.dataset.id, 
						{ _method: "delete" }
					).done(function() {
						$row.remove();
					});
				});
